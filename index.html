<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WebAR KML Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://rawcdn.githack.com/AR-js-org/AR.js/3.4.2/aframe/build/aframe-ar.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-omnivore@0.3.4/leaflet-omnivore.min.js"></script>
  <style> body { margin:0; overflow:hidden; } </style>
</head>
<body>
  <a-scene embedded vr-mode-ui="enabled: false" arjs="sourceType: camera; debugUIEnabled: false; gpsMinDistance: 10;">
    <a-camera gps-camera rotation-reader></a-camera>
  </a-scene>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      omnivore.kml('thermi.kml').on('ready', function() {
        this.eachLayer(layer => {
          if(layer.getLatLngs) {
            const coords = layer.getLatLngs()[0];
            coords.forEach(pt => {
              const sphere = document.createElement('a-sphere');
              sphere.setAttribute('gps-entity-place', `latitude: ${pt.lat}; longitude: ${pt.lng};`);
              sphere.setAttribute('radius', '1');
              sphere.setAttribute('color', '#FF0000');
              sphere.setAttribute('opacity', '0.8');
              document.querySelector('a-scene').appendChild(sphere);
            });
          }
        });
      });
    });
  </script>
</body>
</html>
